<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF & QR Generator - Professional Tool</title>
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://unpkg.com/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --bg: #0f0f23; --glass: rgba(255,255,255,0.1); }
        .glass { background: var(--glass); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.2); }
        .gradient-text { background: linear-gradient(45deg, #8b5cf6, #ec4899, #06b6d4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .tab-active { background-color: rgba(139, 92, 246, 0.5) !important; color: #a78bfa !important; border: 1px solid #8b5cf6; }
        .preview-area { min-height: 300px; border: 2px dashed rgba(255,255,255,0.1); border-radius: 20px; background: rgba(0,0,0,0.2); }
        iframe { width: 100%; height: 450px; border-radius: 15px; }
    </style>
</head>
<body class="bg-[#0f0f23] text-white font-sans pb-20">
    
    <nav class="glass fixed top-0 w-full z-50 p-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-xl font-black gradient-text">PDF-QR Pro</h1>
            <div class="flex gap-4 text-sm">
                <button onclick="showSection('pdf')" class="hover:text-purple-400">PDF</button>
                <button onclick="showSection('qr')" class="hover:text-emerald-400">QR</button>
            </div>
        </div>
    </nav>

    <section id="pdf" class="pt-24 px-4 max-w-4xl mx-auto">
        <div class="glass p-6 rounded-3xl">
            <h2 class="text-2xl font-bold mb-6 gradient-text">üìÑ PDF Generator</h2>
            
            <div class="flex bg-white/5 rounded-xl p-1 mb-6">
                <button onclick="setPDFMode('text', event)" class="flex-1 py-2 rounded-lg tab-active">Text</button>
                <button onclick="setPDFMode('photo', event)" class="flex-1 py-2 rounded-lg">Photo</button>
            </div>

            <div class="mb-6">
                <textarea id="pdfInputText" rows="4" class="w-full p-4 rounded-xl bg-white/5 border border-white/10" placeholder="·Äô·Äº·Äî·Ä∫·Äô·Ä¨·ÄÖ·Ä¨ ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ ·Ä°·ÄÑ·Ä∫·Äπ·ÄÇ·Äú·Ä≠·Äï·Ä∫·ÄÖ·Ä¨ ·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´..."></textarea>
                <input type="file" id="pdfInputFile" accept="image/*" class="w-full p-4 bg-white/5 rounded-xl hidden">
            </div>

            <button onclick="handlePDFPreview()" class="w-full py-4 bg-purple-600 rounded-xl font-bold mb-8 hover:bg-purple-700 transition-all">üëÅÔ∏è Preview PDF</button>

            <div id="pdfPreviewBox" class="hidden">
                <div class="preview-area mb-4 overflow-hidden">
                    <iframe id="pdfFrame"></iframe>
                </div>
                <button onclick="downloadPDF()" class="w-full py-4 bg-pink-600 rounded-xl font-bold">üíæ Download PDF File</button>
            </div>
        </div>
    </section>

    <section id="qr" class="pt-10 px-4 max-w-4xl mx-auto">
        <div class="glass p-6 rounded-3xl">
            <h2 class="text-2xl font-bold mb-6 gradient-text">üì± QR Generator</h2>
            <input type="text" id="qrInputData" class="w-full p-4 rounded-xl bg-white/5 border border-white/10 mb-6" placeholder="·ÄÖ·Ä¨·Äû·Ä¨·Ä∏ ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ Link ·Äë·Ää·Ä∑·Ä∫·Äï·Ä´...">
            
            <button onclick="handleQRPreview()" class="w-full py-4 bg-emerald-600 rounded-xl font-bold mb-8 hover:bg-emerald-700 transition-all">üëÅÔ∏è Preview QR Code</button>

            <div id="qrPreviewBox" class="hidden text-center">
                <div class="preview-area p-6 mb-4 flex justify-center items-center">
                    <canvas id="qrCanvas" class="max-w-full rounded-lg"></canvas>
                </div>
                <button onclick="downloadQR()" class="w-full py-4 bg-blue-600 rounded-xl font-bold">üíæ Download QR Image</button>
            </div>
        </div>
    </section>

    <script>
        let currentMode = 'text';
        let pdfBlobUrl = null;

        function showSection(id) {
            document.getElementById('pdf').classList.toggle('hidden', id !== 'pdf');
            document.getElementById('qr').classList.toggle('hidden', id !== 'qr');
        }

        // PDF Type Switch
        function setPDFMode(mode, e) {
            currentMode = mode;
            document.getElementById('pdfInputText').classList.toggle('hidden', mode !== 'text');
            document.getElementById('pdfInputFile').classList.toggle('hidden', mode !== 'photo');
            e.target.parentElement.querySelectorAll('button').forEach(b => b.classList.remove('tab-active'));
            e.target.classList.add('tab-active');
        }

        // --- PDF Preview Logic ---
        async function handlePDFPreview() {
            try {
                const { PDFDocument, rgb } = PDFLib;
                const pdfDoc = await PDFDocument.create();
                
                // ·Äô·Äº·Äî·Ä∫·Äô·Ä¨·ÄÖ·Ä¨·Ä°·Äê·ÄΩ·ÄÄ·Ä∫ Font Load ·Äú·ÄØ·Äï·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ (Error ·Äô·Äê·ÄÄ·Ä∫·Ä°·Ä±·Ä¨·ÄÑ·Ä∫ ·Äû·Ä±·ÄÅ·Äª·Ä¨·Äï·Ä±·Ä´·ÄÄ·Ä∫·Äú·Ä≠·ÄØ·Ä°·Äï·Ä∫·Äû·Ää·Ä∫)
                const fontUrl = 'https://cdn.jsdelivr.net/gh/googlefonts/pyidaungsu@master/fonts/ttf/Pyidaungsu-Regular.ttf';
                const fontBytes = await fetch(fontUrl).then(res => {
                    if(!res.ok) throw new Error("Font load ·Äô·Äõ·Äï·Ä´");
                    return res.arrayBuffer();
                });
                const customFont = await pdfDoc.embedFont(fontBytes);

                const page = pdfDoc.addPage([595, 842]);
                const { height } = page.getSize();

                if (currentMode === 'text') {
                    const text = document.getElementById('pdfInputText').value || "No Content";
                    page.drawText(text, { x: 50, y: height - 100, size: 16, font: customFont });
                } else {
                    const file = document.getElementById('pdfInputFile').files[0];
                    if (!file) return alert("·Äì·Ä¨·Äê·Ä∫·Äï·ÄØ·Ä∂·Ä°·Äõ·ÄÑ·Ä∫·Äõ·ÄΩ·Ä±·Ä∏·Äï·Ä´");
                    const imgBytes = await file.arrayBuffer();
                    const img = file.type.includes('png') ? await pdfDoc.embedPng(imgBytes) : await pdfDoc.embedJpg(imgBytes);
                    page.drawImage(img, { x: 50, y: height - 400, width: 350, height: 350 });
                }

                const pdfBytes = await pdfDoc.save();
                if (pdfBlobUrl) URL.revokeObjectURL(pdfBlobUrl); // Memory ·Äõ·Äæ·ÄÑ·Ä∫·Ä∏·Äõ·Äî·Ä∫
                const blob = new Blob([pdfBytes], { type: 'application/pdf' });
                pdfBlobUrl = URL.createObjectURL(blob);
                
                document.getElementById('pdfFrame').src = pdfBlobUrl;
                document.getElementById('pdfPreviewBox').classList.remove('hidden');
            } catch (err) {
                alert("Error: " + err.message);
                console.error(err);
            }
        }

        function downloadPDF() {
            if (!pdfBlobUrl) return;
            const a = document.createElement('a');
            a.href = pdfBlobUrl;
            a.download = `Document_${Date.now()}.pdf`;
            a.click();
        }

        // --- QR Preview Logic ---
        function handleQRPreview() {
            const data = document.getElementById('qrInputData').value;
            if (!data) return alert("Data ·Äê·ÄÖ·Ä∫·ÄÅ·ÄØ·ÄÅ·ÄØ·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´");

            const canvas = document.getElementById('qrCanvas');
            // QRCode library ·ÄÄ·Ä≠·ÄØ ·Äû·Ä±·ÄÅ·Äª·Ä¨·ÄÅ·Ä±·Ä´·Ä∫·Äö·Ä∞·Ä°·Äû·ÄØ·Ä∂·Ä∏·Äï·Äº·ÄØ·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏
            QRCode.toCanvas(canvas, data, {
                width: 250,
                margin: 2,
                color: { dark: "#000000", light: "#ffffff" }
            }, function (error) {
                if (error) {
                    alert("QR Error: " + error);
                } else {
                    document.getElementById('qrPreviewBox').classList.remove('hidden');
                }
            });
        }

        function downloadQR() {
            const canvas = document.getElementById('qrCanvas');
            const link = document.createElement('a');
            link.href = canvas.toDataURL("image/png");
            link.download = `QR_${Date.now()}.png`;
            link.click();
        }
    </script>
</body>
</html>